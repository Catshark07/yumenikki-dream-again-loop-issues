[gd_scene load_steps=21 format=4 uid="uid://b67q2b5hm6tsu"]

[ext_resource type="Script" uid="uid://b1ofr4umso5jf" path="res://src/systems/scenes/game/game_scene.gd" id="1_inoc5"]
[ext_resource type="Shader" uid="uid://dqxrs4a4y611c" path="res://src/shaders/panorama/linear.gdshader" id="2_odm8p"]
[ext_resource type="Texture2D" uid="uid://cpsg4xvrbf3mo" path="res://src/images/panorama/eyeball_panorama.png" id="3_4j00j"]
[ext_resource type="PackedScene" uid="uid://bku0eqinjwowa" path="res://src/levels/__ignore/door.tscn" id="3_07q2v"]
[ext_resource type="PackedScene" uid="uid://djnomncx1otsq" path="res://src/systems/seamless_detector.tscn" id="4_cu3a0"]
[ext_resource type="PackedScene" uid="uid://c8bnpo28a373g" path="res://src/systems/camera/camera.tscn" id="4_sthxv"]
[ext_resource type="Script" uid="uid://b4b3kjcm65mv6" path="res://src/systems/audio/bgm.gd" id="5_cu3a0"]
[ext_resource type="TileSet" uid="uid://ucja6rk8c0dh" path="res://src/levels/__ignore/tile_set/eyeball.tres" id="5_pagnx"]
[ext_resource type="AudioStream" uid="uid://dexpefjcufc0b" path="res://src/audio/bgm/world_eyeball.ogg" id="6_jutn4"]
[ext_resource type="PackedScene" uid="uid://ryhx8o46er7i" path="res://src/player/2D/madotsuki/madotsuki.tscn" id="9_4j00j"]
[ext_resource type="Script" uid="uid://4dkyll6fxqod" path="res://src/systems/region/region.gd" id="11_ppt66"]
[ext_resource type="Script" uid="uid://f4sb25g3gpic" path="res://src/systems/event/sequence/game/sequence_region.gd" id="12_04s3o"]
[ext_resource type="Script" uid="uid://ofyfa3d6ql28" path="res://src/systems/components/independent/spawn_point.gd" id="12_d5n0m"]
[ext_resource type="Script" uid="uid://c1od80bn28h0l" path="res://src/systems/event/sequence/sequence_interface.gd" id="13_x4bpl"]
[ext_resource type="Script" uid="uid://c0ymap76lrhgr" path="res://src/systems/event/scene/travel_to_scene.gd" id="14_d5n0m"]
[ext_resource type="Script" uid="uid://dkbhr01xbyr60" path="res://src/systems/components/independent/scene_traversal.gd" id="16_fot1s"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_ppt66"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_04s3o"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_sthxv"]
shader = ExtResource("2_odm8p")
shader_parameter/dirX = -1.0
shader_parameter/dirY = 1.0
shader_parameter/scroll_speed = 0.05
shader_parameter/uv_offset_initial = Vector2(0, 0)
shader_parameter/offset_strength = 0.15
shader_parameter/offset_strength_x_influence = 1.0
shader_parameter/offset_strength_y_influence = 1.0
shader_parameter/initial_uv_offset = Vector2(0, 0)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_fot1s"]
size = Vector2(16, 16)

[node name="eyeball_world" type="Node"]
script = ExtResource("1_inoc5")
scene_load_sequence = Object(Node,"_import_path":NodePath(""),"unique_name_in_owner":false,"process_mode":0,"process_priority":0,"process_physics_priority":0,"process_thread_group":0,"physics_interpolation_mode":0,"auto_translate_mode":0,"editor_description":"","script":ExtResource("13_x4bpl"),"order":Array[Node]([]),"remove_invalid_events":true,"halt_sequence":false,"deferred":true,"wait_til_finished":true,"skip_warning":false)

scene_unload_sequence = Object(Node,"_import_path":NodePath(""),"unique_name_in_owner":false,"process_mode":0,"process_priority":0,"process_physics_priority":0,"process_thread_group":0,"physics_interpolation_mode":0,"auto_translate_mode":0,"editor_description":"","script":ExtResource("13_x4bpl"),"order":Array[Node]([]),"remove_invalid_events":true,"halt_sequence":false,"deferred":true,"wait_til_finished":true,"skip_warning":false)

load_transition = SubResource("ShaderMaterial_ppt66")
unload_transition = SubResource("ShaderMaterial_04s3o")
metadata/_custom_type_script = "uid://b1ofr4umso5jf"

[node name="BGM" type="Node" parent="."]
script = ExtResource("5_cu3a0")
stream = ExtResource("6_jutn4")
metadata/_custom_type_script = "uid://b4b3kjcm65mv6"

[node name="panorama (bottom_layer)" type="CanvasLayer" parent="."]
layer = -30

[node name="EyeballPanorama" type="TextureRect" parent="panorama (bottom_layer)"]
material = SubResource("ShaderMaterial_sthxv")
offset_right = 480.0
offset_bottom = 300.0
texture = ExtResource("3_4j00j")
stretch_mode = 6

[node name="camera" parent="." instance=ExtResource("4_sthxv")]

[node name="camera_handler" parent="camera" index="0" node_paths=PackedStringArray("target")]
target = NodePath("../../y_order/Madotsuki")

[node name="y_order" type="Node2D" parent="."]
y_sort_enabled = true

[node name="nexus" parent="y_order" instance=ExtResource("3_07q2v")]
position = Vector2(60, 15)
rect = Object(CollisionShape2D,"_import_path":NodePath(""),"unique_name_in_owner":false,"process_mode":0,"process_priority":0,"process_physics_priority":0,"process_thread_group":0,"physics_interpolation_mode":0,"auto_translate_mode":0,"editor_description":"","visible":true,"modulate":Color(1, 1, 1, 1),"self_modulate":Color(1, 1, 1, 1),"show_behind_parent":false,"top_level":false,"light_mask":1,"visibility_layer":1,"z_index":0,"z_as_relative":true,"y_sort_enabled":false,"texture_filter":0,"texture_repeat":0,"material":null,"use_parent_material":false,"position":Vector2(0, 0),"rotation":0.0,"scale":Vector2(1, 1),"skew":0.0,"shape":null,"disabled":false,"one_way_collision":false,"one_way_collision_margin":1.0,"debug_color":Color(0.9, 0, 0.7, 0.3),"script":null)


[node name="tilemap" type="TileMapLayer" parent="y_order"]
y_sort_enabled = true
tile_map_data = PackedByteArray("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AAAKACMAAAAAAAAAABAMABMAAAAAAAAAABAoAA8AAAAAAAAAABAvACEAAAAAAAAAAABTACQAAAAAAAEAAABUACYAAAAAAAEAAABVACQAAAAAAAAAAABVACYAAAAAAAEAAABPACYAAAAAAAAAAAA0AAkAAAAEAAIAAAA0AAgAAAAEAAAAAAA1AAYAAAAEAAAAAAA1AAcAAAAEAAIAAAA6AAYAAAAEAAAAAAA6AAcAAAAEAAIAAAA7AAoAAAAEAAMAABA7AAsAAAAEAAUAABA7AAgAAAAEAAAAABA7AAkAAAAEAAIAABA3AAcAAAAEAAAAABA3AAgAAAAEAAIAABA3AAoAAAAEAAUAABAvAAoAAAAEAAAAAAAxAAkAAAAEAAAAAAAxAAoAAAAEAAIAAAAkACEAAAAEAAAAAAAkACIAAAAEAAIAAAAkACMAAAAEAAMAAAAkACQAAAAEAAQAAAAlACAAAAAEAAAAAAAlACEAAAAEAAIAAAAlACIAAAAEAAMAAAAlACMAAAAEAAQAAAAmAB8AAAAEAAAAAAAmACAAAAAEAAIAAAAmACEAAAAEAAMAAAAmACIAAAAEAAQAAAAkACUAAAAEAAUAAAAlACQAAAAEAAUAAAAmACMAAAAEAAUAAAAnAB4AAAAEAAAAAAAnAB8AAAAEAAIAAAAnACAAAAAEAAMAAAAnACEAAAAEAAQAAAAnACIAAAAEAAUAAAAjACQAAAACAAEAABDw/wwAAAAEAAAAABDw/w0AAAAEAAIAABDw/w4AAAAEAAMAABDw/w8AAAAEAAQAABDw/xAAAAAEAAUAABDx/w4AAAAEAAIAABDx/w8AAAAEAAMAABDx/xAAAAAEAAQAABDx/xEAAAAEAAUAABDx/w0AAAAEAAAAABDz/w8AAAAEAAAAAADz/xAAAAAEAAIAAADz/xEAAAAEAAMAAADz/xIAAAAEAAQAAADz/xMAAAAEAAUAAADv/w8AAAAEAAAAABDv/xAAAAAEAAIAABDv/xEAAAAEAAQAABDv/xIAAAAEAAUAABBHABoAAAAAAAEAAABFABwAAAAAAAAAAABGAB0AAAAAAAAAAABPAB0AAAAAAAAAAABQAB8AAAAAAAEAAAABAEMAAAAEAAUAABADAD8AAAAAAAAAABADAEAAAAAEAAAAAAADAEEAAAAEAAIAAAADAEIAAAAEAAQAAAADAEMAAAAEAAUAAAAAAEAAAAAAAAEAAAAAAEEAAAAEAAAAABAAAEIAAAAEAAIAABAAAEMAAAAEAAQAABAAAEQAAAAEAAUAABAEAEEAAAAEAAAAAAAEAEIAAAAEAAIAAAAEAEMAAAAEAAQAAAAEAEQAAAAEAAUAAAAEAEAAAAAAAAAAABAFAEEAAAAAAAAAABAFAEIAAAAEAAAAAAAFAEMAAAAEAAIAAAAFAEQAAAAEAAQAAAAFAEUAAAAEAAUAAAAGAEIAAAAAAAAAABAGAEMAAAAEAAAAAAAGAEQAAAAEAAIAAAAGAEUAAAAEAAQAAAAGAEYAAAAEAAUAAAD+/0IAAAAAAAEAAAD+/0MAAAAEAAAAABD+/0QAAAAEAAIAABD+/0UAAAAEAAQAABD+/0YAAAAEAAUAABD//0EAAAAAAAEAAAD//0IAAAAEAAAAABD//0MAAAAEAAIAABD//0QAAAAEAAQAABD//0UAAAAEAAUAABA5AD0AAAAKAAQAAAA7ADsAAAAEAAAAAAA7ADwAAAAEAAIAAAA7AD0AAAAEAAMAAAA7AD4AAAAEAAQAAAA7AD8AAAAEAAUAAAA3AD0AAAAEAAMAABA3AD4AAAAEAAQAABA3AD8AAAAEAAUAABA3ADsAAAAEAAAAABA3ADwAAAAEAAIAABA5AEAAAAAAAAQAAAA6AEEAAAAAAAYAAAA4AEIAAAAAAAgAAAA8AD8AAAAAAAYAAAA4AD4AAAAAAAYAAABgAC8AAAAFAAMAAABJAPr/AAAFAAYAAABMAPn/AAAEAAMAAABMAPr/AAAEAAUAAABMAPf/AAAEAAAAAABMAPj/AAAEAAIAAABHAPf/AAAEAAAAABBHAPj/AAAEAAIAABBHAPn/AAAEAAMAABBHAPr/AAAEAAUAABBeACwAAAAEAAAAABBeAC0AAAAEAAIAABBeAC4AAAAEAAMAABBeAC8AAAAEAAUAABBjACwAAAAEAAAAAABjAC0AAAAEAAIAAABjAC4AAAAEAAMAAABjAC8AAAAEAAUAAAA=")
tile_set = ExtResource("5_pagnx")

[node name="seamless_detector" parent="y_order" instance=ExtResource("4_cu3a0")]
position = Vector2(-330, -270)
tile_size = Vector2i(15, 15)
expansion = Vector2i(80, 70)
boundary_size = Vector2i(1680, 1320)
min_bound_size_multiplier = Vector2i(32, 18)
min_boundary_size = Vector2i(480, 270)

[node name="Madotsuki" parent="y_order" instance=ExtResource("9_4j00j")]
position = Vector2(75, 45)

[node name="AreaRegion" type="Area2D" parent="y_order"]
position = Vector2(40, 976)
collision_layer = 1073741824
collision_mask = 1073741824
script = ExtResource("11_ppt66")
rect = Object(CollisionShape2D,"_import_path":NodePath(""),"unique_name_in_owner":false,"process_mode":0,"process_priority":0,"process_physics_priority":0,"process_thread_group":0,"physics_interpolation_mode":0,"auto_translate_mode":0,"editor_description":"","visible":true,"modulate":Color(1, 1, 1, 1),"self_modulate":Color(1, 1, 1, 1),"show_behind_parent":false,"top_level":false,"light_mask":1,"visibility_layer":1,"z_index":0,"z_as_relative":true,"y_sort_enabled":false,"texture_filter":0,"texture_repeat":0,"material":null,"use_parent_material":false,"position":Vector2(0, 0),"rotation":0.0,"scale":Vector2(1, 1),"skew":0.0,"shape":SubResource("RectangleShape2D_fot1s"),"disabled":false,"one_way_collision":false,"one_way_collision_margin":1.0,"debug_color":Color(0.2, 0, 0.7, 0.2),"script":null)

metadata/_custom_type_script = "uid://4dkyll6fxqod"

[node name="rect" type="CollisionShape2D" parent="y_order/AreaRegion"]
shape = SubResource("RectangleShape2D_fot1s")
debug_color = Color(0.2, 0, 0.7, 0.2)

[node name="SpawnPoint" type="Node2D" parent="y_order/AreaRegion" node_paths=PackedStringArray("parent_instead_of_self")]
position = Vector2(-40, -1080)
script = ExtResource("12_d5n0m")
scene_path = "uid://b5h2bldsnmdsb"
parent_instead_of_self = NodePath("..")
as_sibling = true
metadata/_custom_type_script = "uid://ofyfa3d6ql28"

[node name="SequenceRegion" type="Node" parent="y_order/AreaRegion" node_paths=PackedStringArray("enter_sequence", "exit_sequence")]
process_mode = 4
script = ExtResource("12_04s3o")
enter_sequence = NodePath("enter")
exit_sequence = NodePath("exit")
metadata/_custom_type_script = "uid://f4sb25g3gpic"

[node name="enter" type="Node" parent="y_order/AreaRegion/SequenceRegion"]
script = ExtResource("13_x4bpl")

[node name="Event" type="Node" parent="y_order/AreaRegion/SequenceRegion/enter" node_paths=PackedStringArray("scene_traversal")]
script = ExtResource("14_d5n0m")
scene_traversal = NodePath("SceneTraversal")
metadata/_custom_type_script = "uid://0v2nidb8jsha"

[node name="SceneTraversal" type="Node" parent="y_order/AreaRegion/SequenceRegion/enter/Event" node_paths=PackedStringArray("spawn_point")]
script = ExtResource("16_fot1s")
scene_path = "uid://b5h2bldsnmdsb"
spawn_point = NodePath("../../../../SpawnPoint")
metadata/_custom_type_script = "uid://dkbhr01xbyr60"

[node name="exit" type="Node" parent="y_order/AreaRegion/SequenceRegion"]
script = ExtResource("13_x4bpl")

[node name="scene_load_sequence" type="Node" parent="."]
script = ExtResource("13_x4bpl")

[node name="scene_unload_sequence" type="Node" parent="."]
script = ExtResource("13_x4bpl")

[editable path="camera"]
[editable path="y_order/nexus"]
