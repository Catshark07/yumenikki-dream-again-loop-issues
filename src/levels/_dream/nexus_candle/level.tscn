[gd_scene load_steps=17 format=4 uid="uid://dem5ekbdkh84f"]

[ext_resource type="Script" uid="uid://b1ofr4umso5jf" path="res://src/systems/scenes/game/game_scene.gd" id="1_g21c4"]
[ext_resource type="TileSet" uid="uid://dqn55e6ldvawb" path="res://src/levels/__ignore/tile_set/world_tile_sets/candle.tres" id="2_mqglx"]
[ext_resource type="PackedScene" uid="uid://c8bnpo28a373g" path="res://src/systems/camera/camera.tscn" id="5_mqglx"]
[ext_resource type="PackedScene" uid="uid://ryhx8o46er7i" path="res://src/player/2D/madotsuki/madotsuki.tscn" id="6_6kogc"]
[ext_resource type="Script" uid="uid://jf85vmwx4pj" path="res://src/player/2D/scripts/pl_variables.gd" id="6_ksaur"]
[ext_resource type="Shader" uid="uid://dqxrs4a4y611c" path="res://src/shaders/panorama/linear.gdshader" id="7_246it"]
[ext_resource type="Texture2D" uid="uid://b2pj4o2ufttv7" path="res://src/images/panorama/candle_panorama.png" id="8_l0sty"]
[ext_resource type="Script" uid="uid://dxx2gbg56i1ts" path="res://src/systems/sequencing/event/scene/apply_panorama.gd" id="9_g3i3s"]
[ext_resource type="TileSet" uid="uid://b0kyfgy4bib24" path="res://src/levels/__ignore/tile_set/_common_objs.tres" id="9_ksaur"]
[ext_resource type="PackedScene" uid="uid://bku0eqinjwowa" path="res://src/levels/__ignore/door.tscn" id="10_uvoel"]
[ext_resource type="Texture2D" uid="uid://dr7f1rsayw4om" path="res://src/levels/__ignore/doors/door_candle.png" id="11_g3i3s"]
[ext_resource type="Script" uid="uid://c1od80bn28h0l" path="res://src/systems/sequencing/sequence_interface.gd" id="18_othme"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_ki2h2"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_43qq2"]

[sub_resource type="Resource" id="Resource_lqjj8"]
resource_local_to_scene = true
resource_name = "pl_variables"
script = ExtResource("6_ksaur")

[sub_resource type="ShaderMaterial" id="ShaderMaterial_6p60u"]
shader = ExtResource("7_246it")
shader_parameter/dirX = 0.20000001788144006
shader_parameter/dirY = 1.0
shader_parameter/scroll_speed = 0.02999999932944
shader_parameter/initial_uv_offset = Vector2(0, 0)
shader_parameter/offset_strength = 0.0
shader_parameter/offset_strength_influence = Vector2(1, 1)
shader_parameter/overlay_modulate = Color(1, 1, 1, 1)
shader_parameter/transparency = 0.0
shader_parameter/optional_gradient = false

[node name="candle_world" type="Node" node_paths=PackedStringArray("seq_initial", "seq_free")]
script = ExtResource("1_g21c4")
seq_initial = NodePath("on_initial")
seq_free = NodePath("on_free")
load_transition = SubResource("ShaderMaterial_ki2h2")
unload_transition = SubResource("ShaderMaterial_43qq2")
metadata/_custom_type_script = "uid://b1ofr4umso5jf"

[node name="camera" parent="." node_paths=PackedStringArray("initial_target") instance=ExtResource("5_mqglx")]
position = Vector2(176, 80)
initial_target = NodePath("../y_order/madotsuki")

[node name="y_order" type="Node2D" parent="."]
y_sort_enabled = true

[node name="candles" type="TileMapLayer" parent="y_order"]
y_sort_enabled = true
tile_map_data = PackedByteArray("AAACAAsAAAAAAAMAAAAEAAgAAAAAAAMAAAACAAUAAAAAAAMAAAACAAYAAAAAAAEAAAACAAwAAAAAAAEAAAALAAsAAAACAAEAAAALAAwAAAACAAIAAAALAAoAAAAAAAMAAAAIAA0AAAAAAAMAAAAIAA4AAAAAAAEAAAD+/wIAAAAAAAMAAAD+/wMAAAAAAAEAAAAEAAkAAAAAAAEAAAAHAAoAAAAAAAMAAAAHAAsAAAAAAAEAAAAHAAMAAAAAAAMAAAAHAAQAAAAAAAEAAAD+/wUAAAAAAAMAAAD+/wYAAAACAAEAAAD+/wcAAAACAAIAAAAAAAgAAAAAAAMAAAAAAAkAAAAAAAEAAAATAAsAAAAAAAMAAAATAAwAAAAAAAEAAAAKAAgAAAAAAAMAAAAKAAkAAAAAAAEAAAAHAP7/AAAAAAMAAAAHAP//AAACAAEAAAAHAAAAAAACAAIAAAADAAYAAAAAAAMAAAADAAcAAAAAAAEAAAAUAA0AAAAAAAEAAAAUAAwAAAAAAAMAAAAKAAwAAAAAAAMAAAAKAA0AAAAAAAEAAAABAAkAAAAAAAMAAAABAAoAAAAAAAEAAAD8/wcAAAAAAAMAAAD8/wgAAAAAAAEAAAD//wMAAAAAAAMAAAD//wQAAAAAAAEAAAAJAAAAAAAAAAMAAAAJAAEAAAAAAAEAAAAJAAkAAAAAAAMAAAAJAAoAAAAAAAEAAAALAAQAAAAAAAMAAAALAAUAAAAAAAEAAAAMAAUAAAAAAAMAAAAMAAYAAAAAAAEAAAAGAAUAAAAAAAMAAAAGAAYAAAACAAEAAAAGAAcAAAACAAIAAAApAAUAAAAAAAMAAAApAAYAAAAAAAEAAAAsAAYAAAAAAAMAAAAsAAcAAAAAAAEAAAAlAAUAAAAAAAMAAAAlAAYAAAAAAAEAAAAnAAgAAAAAAAMAAAAnAAkAAAAAAAEAAAAoAAIAAAAAAAMAAAAoAAMAAAAAAAEAAAApAAMAAAAAAAMAAAApAAQAAAAAAAEAAAAuAAcAAAAAAAMAAAAuAAgAAAAAAAEAAAAxAAcAAAAAAAMAAAAxAAgAAAACAAEAAAAxAAkAAAACAAIAAAAyAAkAAAAAAAMAAAA3AAcAAAAAAAMAAAA3AAgAAAACAAEAAAA3AAkAAAACAAIAAAA5AAgAAAAAAAMAAAA5AAkAAAAAAAEAAAAhAAIAAAAAAAEAAAAdAAAAAAAAAAMAAAAdAAEAAAAAAAEAAAAhAAEAAAAAAAMAAAAhAAQAAAAAAAMAAAAhAAUAAAAAAAEAAAAgAAoAAAAAAAMAAAAgAAsAAAAAAAEAAAB2ABUAAAAAAAMAAAB2ABYAAAAAAAEAAAB3ABYAAAAAAAMAAAB3ABcAAAAAAAEAAAAaADEAAAAAAAMAAAAaADIAAAAAAAEAAAAbAC8AAAAAAAMAAAAbADAAAAACAAEAAAAbADEAAAACAAIAAAAcADEAAAAAAAMAAAAcADIAAAAAAAEAAACDACsAAAAAAAMAAACDACwAAAAAAAEAAACEACsAAAAAAAMAAACEACwAAAAAAAEAAACdACAAAAAAAAMAAACdACEAAAAAAAEAAACeACEAAAAAAAMAAACeACIAAAAAAAEAAACsABUAAAAAAAMAAACsABYAAAAAAAEAAACtABYAAAAAAAMAAACtABcAAAAAAAEAAAAWABkAAAAAAAMAAAAWABoAAAAAAAEAAAAXABkAAAAAAAMAAAAXABoAAAAAAAEAAAAaABsAAAAAAAMAAAAaABwAAAACAAEAAAAaAB0AAAACAAIAAAAcAB0AAAAAAAMAAAAcAB4AAAAAAAEAAABSACMAAAAAAAMAAABSACQAAAAAAAEAAABTACIAAAAAAAMAAABTACMAAAAAAAEAAAC8ADoAAAAAAAMAAAC8ADsAAAAAAAEAAAC9ADsAAAAAAAMAAAC9ADwAAAAAAAEAAAC6ADwAAAAAAAMAAAC6AD0AAAAAAAEAAAA6AEMAAAAAAAMAAAA6AEQAAAAAAAEAAAA7AEQAAAAAAAMAAAA7AEUAAAAAAAEAAAAaAEoAAAAAAAMAAAAaAEsAAAACAAEAAAAaAEwAAAACAAIAAABvADoAAAAAAAMAAABvADsAAAACAAEAAABvADwAAAACAAIAAABxADoAAAACAAEAABBxADsAAAACAAEAAABxADwAAAACAAIAAABxADkAAAAAAAMAAACGACoAAAAAAAMAAACGACsAAAACAAEAABCGACwAAAACAAEAAACGAC0AAAACAAIAAACqABQAAAAAAAMAAACqABUAAAACAAEAABCqABYAAAACAAEAAACqABcAAAACAAIAAAB4ABMAAAAAAAMAAAB4ABQAAAACAAEAABB4ABUAAAACAAEAAAB4ABYAAAACAAIAAAAkAAEAAAAAAAMAAAAkAAIAAAACAAEAABAkAAMAAAACAAEAAAAkAAQAAAACAAIAAAD+/woAAAAAAAMAAAD+/wsAAAACAAEAABD+/wwAAAACAAEAAAD+/w0AAAACAAIAAADWACEAAAAAAAMAAADWACIAAAACAAEAABDWACMAAAACAAEAAADWACQAAAACAAIAAADZACIAAAAAAAMAAADZACMAAAACAAEAABDZACQAAAACAAEAAADZACUAAAACAAIAAAC0AE0AAAAAAAMAAAC0AE4AAAACAAEAAAC0AE8AAAACAAEAABC0AFAAAAACAAEAAAC0AFEAAAACAAIAAADjABEAAAAAAAMAAADjABIAAAACAAEAAADjABMAAAACAAIAAADlABMAAAAAAAMAAADlABQAAAAAAAEAAAAEAUYAAAAAAAMAAAAEAUcAAAAAAAEAAAACAUMAAAAAAAMAAAACAUQAAAAAAAEAAAABAUYAAAAAAAMAAAABAUcAAAAAAAEAAAAFAUMAAAAAAAMAAAAFAUQAAAACAAEAAAAFAUUAAAACAAIAAABkAGIAAAAAAAMAAABkAGMAAAACAAEAAABkAGQAAAACAAIAAABmAGIAAAAAAAMAAABmAGMAAAAAAAEAAABiAGEAAAAAAAMAAABiAGIAAAAAAAEAAABuAE0AAAAAAAMAAABuAE4AAAAAAAEAAAAFAWAAAAAAAAMAAAAFAWEAAAAAAAEAAAAGAWEAAAAAAAMAAAAGAWIAAAAAAAEAAADOAFsAAAAAAAMAAADOAFwAAAACAAEAAADOAF0AAAACAAIAAAAIASEAAAAAAAMAAAAIASIAAAACAAEAAAAIASMAAAACAAIAAACZAEEAAAAAAAMAAACZAEIAAAAAAAEAAACfAEAAAAAAAAMAAACfAEEAAAAAAAEAAAD0ADkAAAAAAAMAAAD0ADoAAAAAAAEAAAA5AC8AAAAAAAMAAAA5ADAAAAAAAAEAAABJAA8AAAAAAAMAAABJABAAAAAAAAEAAACZAAsAAAAAAAMAAACZAAwAAAAAAAEAAAArAFsAAAAAAAMAAAArAFwAAAAAAAEAAAD4/w8AAAAAAAMAAAD4/xAAAAAAAAEAAAAYAGkAAAAAAAMAAAAYAGoAAAAAAAEAAAAfAGoAAAAAAAMAAAAfAGsAAAACAAEAAAAfAGwAAAACAAIAAABtAGgAAAAAAAMAAABtAGkAAAACAAEAAABtAGoAAAACAAIAAABvAGoAAAAAAAMAAABvAGsAAAAAAAEAAABtAGsAAAAAAAMAAABtAGwAAAAAAAEAAADlAGcAAAAAAAMAAADlAGgAAAACAAEAAADlAGkAAAACAAIAAADmAGgAAAAAAAMAAADmAGkAAAAAAAEAAADhAGoAAAAAAAMAAADhAGsAAAAAAAEAAAADAWcAAAAAAAMAAAADAWgAAAAAAAEAAAC1AGcAAAAAAAMAAAC1AGgAAAAAAAEAAAAIABoAAAAAAAMAAAAIABsAAAACAAEAAAAIABwAAAACAAIAAAAKAB0AAAAAAAMAAAAKAB4AAAAAAAEAAAAOACgAAAAAAAMAAAAOACkAAAAAAAEAAAAMACoAAAAAAAMAAAAMACsAAAAAAAEAAAARAEMAAAAAAAMAAAARAEQAAAAAAAEAAAAOAD8AAAAAAAMAAAAOAEAAAAACAAEAAAAOAEEAAAACAAIAAAAIAFoAAAAAAAMAAAAIAFsAAAAAAAEAAAARAGAAAAAAAAMAAAARAGEAAAAAAAEAAAANAGoAAAAAAAMAAAANAGsAAAAAAAEAAAA7AP//AAAAAAMAAAA7AAAAAAACAAEAAAA7AAEAAAACAAIAAABvAAEAAAAAAAMAAABvAAIAAAAAAAEAAACBAP//AAAAAAMAAACBAAAAAAAAAAEAAADcAAMAAAAAAAMAAADcAAQAAAAAAAEAAAD/AP//AAAAAAMAAAD/AAAAAAAAAAEAAAAqAAwAAAACAAEAAAAqAA0AAAACAAIAAAAuAAsAAAAAAAMAAAAoAAsAAAAAAAMAAAAoAAwAAAAAAAEAAAAqAAsAAAAAAAMAAAArAA0AAAAAAAMAAAArAA4AAAAAAAEAAAAuAAwAAAACAAEAAAAuAA0AAAACAAIAAAAvAAsAAAAAAAMAAAAvAAwAAAAAAAEAAAAvABAAAAAAAAMAAAAvABEAAAAAAAEAAAAwAA8AAAAAAAMAAAAwABAAAAAAAAEAAAAzAAwAAAAAAAMAAAAzAA0AAAAAAAEAAAA2AAwAAAAAAAMAAAA2AA0AAAACAAEAAAA2AA4AAAACAAIAAAAgAA0AAAAAAAMAAAAgAA4AAAAAAAEAAAAZARsAAAAAAAMAAAAZARwAAAACAAEAAAAZAR0AAAACAAIAAAAaASAAAAAAAAMAAAAaASEAAAAAAAEAAAAcAR0AAAAAAAMAAAAcAR4AAAACAAEAAAAcAR8AAAACAAIAAAAcAVQAAAAAAAMAAAAcAVUAAAAAAAEAAAAdAVUAAAAAAAMAAAAdAVYAAAAAAAEAAAAeAQcAAAAAAAMAAAAeAQgAAAAAAAEAAAAeATIAAAAAAAMAAAAeATMAAAACAAEAAAAeATQAAAACAAIAAAAfAf7/AAAAAAMAAAAfAf//AAACAAEAAAAfAQAAAAACAAIAAAAfAQgAAAAAAAMAAAAfAQkAAAAAAAEAAAAfAWoAAAAAAAMAAAAfAWsAAAAAAAEAAAAkATUAAAAAAAMAAAAkATYAAAAAAAEAAAAqAVUAAAAAAAMAAAAqAVYAAAACAAEAAAAqAVcAAAACAAIAAAAtAQ8AAAAAAAMAAAAtARAAAAAAAAEAAAAyAAoAAAAAAAEAAAAeAAEAAAAAAAMAAAAeAAIAAAAAAAEAAAADAAwAAAAAAAMAAAADAA0AAAAAAAEAAAA=")
tile_set = ExtResource("2_mqglx")

[node name="tent" type="TileMapLayer" parent="y_order"]
y_sort_enabled = true
tile_map_data = PackedByteArray("AABrADMAAAADAAYAAAA=")
tile_set = ExtResource("9_ksaur")

[node name="madotsuki" parent="y_order" instance=ExtResource("6_6kogc")]
position = Vector2(176, 80)
values = SubResource("Resource_lqjj8")

[node name="nexus" parent="y_order" instance=ExtResource("10_uvoel")]
position = Vector2(192, 80)

[node name="renderer" parent="y_order/nexus" index="2"]
texture = ExtResource("11_g3i3s")
hframes = 1
frame_h_count = 1

[node name="on_free" type="Node" parent="."]
script = ExtResource("18_othme")

[node name="on_initial" type="Node" parent="." node_paths=PackedStringArray("order", "front", "back")]
script = ExtResource("18_othme")
order = [NodePath("panorama")]
front = NodePath("panorama")
back = NodePath("panorama")

[node name="panorama" type="Node" parent="on_initial" node_paths=PackedStringArray("subviewport", "pivot")]
script = ExtResource("9_g3i3s")
subviewport = NodePath("subviewport")
pivot = NodePath("pivot")
metadata/_custom_type_script = "uid://0v2nidb8jsha"

[node name="pivot" type="Marker2D" parent="on_initial/panorama"]

[node name="subviewport" type="SubViewport" parent="on_initial/panorama"]
own_world_3d = true
transparent_bg = true
canvas_item_default_texture_filter = 0
canvas_item_default_texture_repeat = 2
size = Vector2i(480, 270)
size_2d_override = Vector2i(480, 270)

[node name="panorama" type="TextureRect" parent="on_initial/panorama/subviewport"]
material = SubResource("ShaderMaterial_6p60u")
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
texture = ExtResource("8_l0sty")
stretch_mode = 6

[editable path="y_order/nexus"]
